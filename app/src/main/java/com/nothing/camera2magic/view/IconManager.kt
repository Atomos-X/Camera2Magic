package com.nothing.camera2magic.view

import android.content.Context
import android.graphics.Bitmap
import android.graphics.BitmapFactory
import android.graphics.drawable.BitmapDrawable
import android.graphics.drawable.Drawable
import android.util.Base64
import android.util.LruCache

enum class ModIcon(val base64: String) {

    IC_LOGO("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"),
    IC_PLUS("iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAeklEQVR4AeyUQQrAMAgE237E/z/Ll7T1MCcpCNIEYQOyhyhZh7DXsfnIwGwCZnbbW51vNJtAZ3NmRUAEREAEEoGI1moRJtX+6GMGTQa4WKXJgLufXixMVvujjxk0GeBilcqACIiACMwmENEa1UnN2QQ6mzP7OwEe+tIHAAD//8eyFq0AAAAGSURBVAMAa55gQcnulDcAAAAASUVORK5CYII="),
    IC_CLOSE("iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABU0lEQVR4AeyUYQ6DIAyFcTuIZ9juf4Z5Bg8y3XsECZrSUhKzPyxUsZS+z1L3CH/+DYBRgVEBtQLzPL9gO75UNQ7r0nhwL+wlLR4+K/GHgUjyxd2KRUgeFOceOmIOTiRTk67rmtcdEKV4KHO4AbBhLxMkiAn+2pDEeYS1+JDfsBoRwhViQ6wE4RZHniYAxlkQXeJM3FIBxtFqEN3iTOoBYDwhcvnRExvs6HY2HNfUM2eS0rwAcW/ZmNGBi+SD2xxdAGZWR0AXAMrOL+EkI/lOAZUHL8AEoXzGKPuTduROa+yDw2XePQAUz2+ehPm8pXkUAwR9zRCtADXxKIpLN0QLgCUO/Ti6ICyAVvFIgIsbQgVI54m8gX8yT0x4vripQ4KoblABsOsN84gznFZCxBx0SqYCoLsXGDu65c2v+QkxYf9yXSifVYAy8K75ABgVuL0CVvP+AAAA//+1kyQ5AAAABklEQVQDABYfmkFeH5T2AAAAAElFTkSuQmCC"),
    IC_PORTRAIT("iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAA9ElEQVR4AeyXQQ6CMBREKXdwwwZN2Oh59ASciwPokdxoVyZeoSF1PkEW9Bd/U40sftOBQqYvk2FTyuLPY90BmqbZbDMHMZZKjjVQ1nXtnXNP7/3NZ4gYxEIIAwWTDYANl8CZ+QJFnjkEGwDGPUSzs9YamyFAOqhAiwe6zxULMPf97FkcAJ/Fp0iaWBxACkz1aQBtQBvQBrQBbUAb0AbEDaSeC6UHE3EAKTDVFwtwHUFtyjmQ84LTQjTfTFpPYgOg7uPk+NICzBOHYgPA2GMD/clUxpidyRBY1cjqsQ5mLMBgxMbHPXMQY4BFLosBInuSXn8yvwAAAP//vL2xXQAAAAZJREFUAwCsjxlQq91pggAAAABJRU5ErkJggg=="),
    IC_FLIP("iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABTklEQVR4AeSWTU7DMBCFMVJuACyySGDNpUDiWEhwKFhDIiUb4ASJMO+pierOjKlat26lID/8Ez/Pl5EbzeXFif+SAOq6/qihlHdIAkDg20no9mupAPtFDVwKoCzLK6TVxxR4zSF8bxD9z+EGrvHscI1jBVAUxRcfJMjFvNbZCmA2N03jGkPz81gPzz1E71O4Z1pTcFGA0HzM8XIAqqp6oWQ2s2XAOfdAnQwAgT8noVu3bBnAr+COWodejbIBrMLp/8sB4KeYkjlYTgZwAfl5dsvNgHzzeZ7tDuACmuVbNgC8sVm+ZQPw3r9SANlo2QDatn2kNqJjkg0Ascx2lgCeqLi1rGyV+Ow/wfcO0aeqYqz/Sq/KwDAMN3LToebjOF7LsxRA3/ff82fT6uUBcg5PtCruuu5H7lcAcsOx56kAZpm1C3QSANJtllkhwLbxHwAAAP//zfLxTAAAAAZJREFUAwAHSpVBW1VUmAAAAABJRU5ErkJggg=="),
    IC_ROTATE("iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAFBlWElmTU0AKgAAAAgAAgESAAMAAAABAAEAAIdpAAQAAAABAAAAJgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAAC+W0ztAAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgoZXuEHAAAC3ElEQVRYCcVXv2tTURTOe3mpKQWHGowkMS+hwUUKFRc3q0ihSBcddFFw6lwoXbp0cxD8AzoKBZ1c7Fa0Sh3TVQcJSTQ4dHAREZImfuf1ntfzXu9Nmvee7YNwzz2/vnPPvefcGys1xlepVG4NBoNVmDzUmUH2qd1u39bJTDzLJBB8y3XdbcwXBU9Ltlqt0/gL2NqBWWgC4C38+mBL8D2sdMm27StSPQo42ZsiplUTsPxuAmSfGLVa7UK32/3LwqjgZO+wEx5LpdJkOp3+w3OMawB4IeappMDJ54kAJHiv17va6XR+SHCisQX3LMvaibNy9hnYAqT9EALvXMB5GnR4G9gusdHPQLlcfs3gWOF0VHAsYqCiu4tFfBgVKVcBMmo9ImWAL6OWf40yTEruZQBR1xV4D+CbJufFYvFSJpOZNcmVD0+MBc2hcXnZaDabuyYb3oIbpOA4zoxJEUH+hmwKGTKpBPjQeykYgbMm+Ckbjh8wo9FotJkOjXQgp0K8RKaUgefK0zuTx2q1Wur3jwoiidKTOHQIrymGTJnU+a80ZWCXELAybyQ6zjduGToAvhMHMK4t94G4fiLbcxlGdhDVEFvldclzCQANag59Yp6CP68tWFGZ+zY0A3yiuQcoI29gmeSF6K+huT/F6p+qycbQAHyLMQkA0J3yU2eWz+cvMx8VuDU0AFwoVVJGBoqg99iQRpZJHtG4eL5joHeF9stms9zuv5CC8ZKQ1mjFLoJoEi9OK8ab4wkCf6X80OIPz+wQ4iF7kcEB/J7AKZBTZYAUY36BV7bMYiIZoIrA774uyEKhkIPMf1vmcrkJqRc7AAJXDk9c52g4z/CCOmBAVMd0vV7v8pzGoVUgFXW0AKeqmGQd8OmFtQ9AZtHh1b6yI58BCQ6g6whgHmhr+Lk+KgjI3qAnPJY8SUcKQIJLZyGa/rgsgHechpACTcfeAoC/1fhh1mdkYh3N6CMzRo3/APdX7vC1S55RAAAAAElFTkSuQmCC"),
    IC_DEBUG("iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADZklEQVR4AeyWS2gTURSGJ4nBEPG9KJi+DC6lKHGhuLIi+CgVHwulLly47VJxI4orLbqraxeKKIiixYKiKC5UkIri0tIkJdaduGgVTZP4/dN7x+lkkkzciGK5/5zHPefcf+49udO484f//hP4e3agp6dnDNRatYxient777WKs/ORdiCXyyVJGACOFjByCP2l0N3dfcz4XIK1Wm3Q5MjdFJEITExMlIvFoki4xVhUC13H2CrEYrFrxofpOIpVjmu0eEQiYGrMJxKJVUa34i3KO+CNubm5FRjzINJoh4BTqVS+mKoV3jIGNoNNIIZfu+Kk0+nP6JFHWwRsVRZMsuXnwWuBpjvHua/VPMexRDIqIhOg0bK2KItW0c+ALQKLn2Vh782z2exK/JFGQwIdHR3L/BWq1eonv43+nYUfCtKBN6ampr56xoKSWBD1z1ACXV1d+1Op1Cxv+sSm0IBe0XK5vIxjSE1PT+8WpNMfaRtL3g+f/hh7nh3cZX1+GUogHo/fMEH9JNeA1+kslpiZmfHImDinVCp9Y07N6LrI+QDUmDtdh+PcMXKRCCVAIW1/vy+yz+i6jHT+rknzucM1fj32GXWDkRI5dmq5lCBCCSgIEk9BjDN+LlvAfiBpwVxesLYkMeOSAnP3sfVzfSM7DA0J2GC6W50uc1SPiLiiOHL3SDZDHQEa8LgfJLvNRV9cQo86LpvApL+WdOP3RB0BFrrqh43M5/NFq7eSbHvexvhrSbd+K+sI2Img5Ge0OuhrZGcyGfdWbDTv99cRgL2axoMN5jwPWr2V5M44ZGMa1bPzdQTshE/eNvqIkS0FZC+YoLtGNhRNCbDtj8g8DDTW8AheqQV8AsIb+hjZ4zpAjab/HYUSIGlYtxhvsuj6xDfrLYPC9q4XUL0RjKHGID7dpqFHGEqAJP2n4xZF35FMJlOu4TgpinnXsvF5grn3GEuBY3LsrSjXCT2CCCXAWw1xi51GxgqFwrPJyUl9+QZNch8L6Y1O8rte19nZmWHHTsnH/EagMaAc8seBvg+jyL2aCCKUgIK4uy9KWmCPoW8Hdozwu/5Ix5fYJS8WfRuLLbqysYdtUlA2JBAMlE2hF0Dfh1uyA7ipOXbsVcDf1GyLgK3EbhzRYgEctfPtyN8i0M4CrWL/fQKtduAnAAAA//9GjEPRAAAABklEQVQDAJK+TlBreqIkAAAAAElFTkSuQmCC")
}

object IconLoader {
    private val bitmapCache = mutableMapOf<ModIcon, Bitmap>()

    fun getBitmap(context: Context, icon: ModIcon): Bitmap {
        return bitmapCache.getOrPut(icon) {
            decodeBase64(icon.base64, context)
        }
    }

    fun get(context: Context, icon: ModIcon): Drawable {
        val bitmap = getBitmap(context, icon)
        return BitmapDrawable(context.resources, bitmap)
    }

    fun getDrawable(context: Context, icon: ModIcon): Drawable = get(context, icon)

    private fun decodeBase64(base64Str: String, context: Context): Bitmap {
        return try {
            val decodedBytes = Base64.decode(base64Str, Base64.DEFAULT)
            val bitmap = BitmapFactory.decodeByteArray(decodedBytes, 0, decodedBytes.size)
            bitmap.density = context.resources.displayMetrics.densityDpi

            bitmap
        } catch (e: Exception) {
            e.printStackTrace()
            Bitmap.createBitmap(1, 1, Bitmap.Config.ARGB_8888)
        }
    }
}